---
title: Format overflow in digital filtering
subtitle: Lab 12, SDP
format:
  html: default
  pdf: default
  ipynb: default

toc: true
number-depth: 2
number-sections: true

jupyter: python3
execute:
  freeze: true
  eval: false
---

\newcommand*{\underuparrow}[1]{\ensuremath{\underset{\uparrow}{#1}}}

## Objective

Students should observe the effects of internal format overflow and underflow
events on the output of a digital filter.

## Theoretical notions

## Theoretical exercises

1. Consider the following system:
	$$H(z) = \frac{1-\frac{1}{2}z^{-1}}{\left(1 - \frac{1}{4}z^{-1}\right)\left(1 + \frac{1}{4}z^{-1}\right)}$$

    a. Draw one of the series implementations of the system
	b. Assume a fixed-point implementation with $b$ bits for the fractionary part.
	Each product is quantized by rounding to this format.
	Find the variance of the rounding noise due to the
	internal multiplications, at the output of the system.

## Practical exercises

1. In Matlab, use the `fdatool` tool to design a low-pass IIR filter
of order 4, Butterworth type, with cutoff frequency equal to 1.5kHz for
a sampling frequency of 44.1kHz.

   Convert the filter to direct form II
   and export it to Simulink (check the option *Build model using basic elements*).

2. In the Simulink model, make two copies of the filter (Copy/Paste).
At the input of both filters put a sample audio signal (e.g. *Kalimba.mp3* or *mtlb*).
For the second filter, the input signal shall be converted to fixed-point
1S2ÃŽ9F data type.

   a. Obtain and plot the difference between the two outputs.
   b. Export the difference signal to Matlab's Workspace and compute its average value
   and the dispersion.

3. Make a new copy of the second filter, and for this copy un-check
in the properties of the *Sum* blocks the option *Saturate on integer overflow*.

   a. What is its effect? Obtain and plot the difference compared to the first filter.
   b. Which of the filters 2 or 3 produces smaller errors?

4. Use the function `normescal()` to compute different scaling norms
for the given filter. Scale the input signal with each one of these norms,
and rescale back the output. What is the effect of this procedure?

## Final questions

1. TBD
